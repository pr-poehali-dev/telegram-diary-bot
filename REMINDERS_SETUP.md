# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º –≤ Telegram –∑–∞ N —á–∞—Å–æ–≤ –¥–æ –≤–∏–∑–∏—Ç–∞ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ: 0-5 —á–∞—Å–æ–≤ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 30 –º–∏–Ω).

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –°–∏—Å—Ç–µ–º–Ω—ã–µ ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞:
   - **–ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å** (0) - –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω—ã
   - **30 –º–∏–Ω—É—Ç** - –∑–∞ –ø–æ–ª—á–∞—Å–∞ –¥–æ –≤–∏–∑–∏—Ç–∞
   - **1 —á–∞—Å** - –∑–∞ —á–∞—Å –¥–æ –≤–∏–∑–∏—Ç–∞
   - **1.5 —á–∞—Å–∞** - –∑–∞ –ø–æ–ª—Ç–æ—Ä–∞ —á–∞—Å–∞
   - ... –¥–æ 5 —á–∞—Å–æ–≤
3. –ù–∞–∂–º–∏—Ç–µ **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å**

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏

Telegram-–±–æ—Ç –∏–º–µ–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `send_reminders()`, –∫–æ—Ç–æ—Ä–∞—è:
- –ß–∏—Ç–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É `reminder_hours` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `settings`
- –ï—Å–ª–∏ `reminder_hours = 0`, –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
- –ò—â–µ—Ç –≤—Å–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (`status = 'confirmed'`)
- –ù–∞—Ö–æ–¥–∏—Ç –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ N —á–∞—Å–æ–≤ (¬±30 –º–∏–Ω –æ–∫–Ω–æ)
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å `telegram_id`

### Endpoint –¥–ª—è –≤—ã–∑–æ–≤–∞

```bash
POST https://functions.poehali.dev/07b2b89b-011e-472f-b782-0f844489a891
Content-Type: application/json

{
  "action": "send_reminders"
}
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–∑–æ–≤–∞

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –Ø–Ω–¥–µ–∫—Å Cloud Functions (—Ç—Ä–∏–≥–≥–µ—Ä —Ç–∞–π–º–µ—Ä–∞)

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ø–Ω–¥–µ–∫—Å Cloud
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Cloud Functions ‚Üí –¢—Ä–∏–≥–≥–µ—Ä—ã
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ç—Ä–∏–≥–≥–µ—Ä:
   - **–¢–∏–ø**: –¢–∞–π–º–µ—Ä
   - **Cron-–≤—ã—Ä–∞–∂–µ–Ω–∏–µ**: `*/30 * * * ? *` (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)
   - **–§—É–Ω–∫—Ü–∏—è**: telegram-bot
   - **Payload**: `{"action": "send_reminders"}`

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –í–Ω–µ—à–Ω–∏–π cron (–Ω–∞–ø—Ä–∏–º–µ—Ä, cron-job.org)

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://cron-job.org
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π cronjob:
   - **URL**: `https://functions.poehali.dev/07b2b89b-011e-472f-b782-0f844489a891`
   - **Method**: POST
   - **Headers**: `Content-Type: application/json`
   - **Body**: `{"action": "send_reminders"}`
   - **Schedule**: Every 30 minutes

#### –í–∞—Ä–∏–∞–Ω—Ç 3: GitHub Actions (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.github/workflows/reminders.yml`:

```yaml
name: Send Reminders

on:
  schedule:
    - cron: '*/30 * * * *'  # –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç

jobs:
  send-reminders:
    runs-on: ubuntu-latest
    steps:
      - name: Call reminder function
        run: |
          curl -X POST https://functions.poehali.dev/07b2b89b-011e-472f-b782-0f844489a891 \
            -H 'Content-Type: application/json' \
            -d '{"action": "send_reminders"}'
```

## –§–æ—Ä–º–∞—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

–ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –≤ Telegram:

```
‚è∞ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –∑–∞–ø–∏—Å–∏

–ü—Ä–∏–≤–µ—Ç, [–ò–º—è]! üëã

–ß–µ—Ä–µ–∑ [N —á 30 –º–∏–Ω] —É –≤–∞—Å –∑–∞–ø–∏—Å—å:

üíá –£—Å–ª—É–≥–∞: [–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏]
üìÖ –î–∞—Ç–∞: [–î–î.–ú–ú.–ì–ì–ì–ì]
üïê –í—Ä–µ–º—è: [–ß–ß:–ú–ú]
üí∞ –¶–µ–Ω–∞: [–°—É–º–º–∞]‚ÇΩ

–î–æ –≤—Å—Ç—Ä–µ—á–∏! ‚ú®
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–î–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å:

```bash
curl -X POST https://functions.poehali.dev/07b2b89b-011e-472f-b782-0f844489a891 \
  -H 'Content-Type: application/json' \
  -d '{"action": "send_reminders"}'
```

–û—Ç–≤–µ—Ç:
```json
{
  "sent": 2,
  "message": "Sent 2 reminders"
}
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –£ –∫–ª–∏–µ–Ω—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω `telegram_id` (–ø—Ä–∏–≤—è–∑–∞–Ω —á–µ—Ä–µ–∑ `/start +79001234567`)
- –ó–∞–ø–∏—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ `confirmed`
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `reminder_hours` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ 0
